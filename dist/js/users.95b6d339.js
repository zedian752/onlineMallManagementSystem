(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["users"],{5895:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[s("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),s("el-breadcrumb-item",[e._v("用户管理")]),s("el-breadcrumb-item",[e._v("用户列表")])],1),s("el-card",{attrs:{shadow:"never"}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:7}},[s("el-input",{attrs:{placeholder:"请输入内容",clearable:""},model:{value:e.queryInfo.query,callback:function(t){e.$set(e.queryInfo,"query",t)},expression:"queryInfo.query"}},[s("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(t){return e.getUserList()}},slot:"append"})],1)],1),s("el-col",{attrs:{span:4}},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.isAddUserDialogVisible=!0}}},[e._v("添加用户")])],1)],1),s("el-table",{attrs:{data:e.userInfo.userlist,border:"",stripe:""}},[s("el-table-column",{attrs:{type:"index",label:"#"}}),s("el-table-column",{attrs:{label:"姓名",prop:"username"}}),s("el-table-column",{attrs:{label:"邮箱",prop:"email"}}),s("el-table-column",{attrs:{label:"电话",prop:"mobile"}}),s("el-table-column",{attrs:{label:"角色",prop:"role_name"}}),s("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-switch",{attrs:{"active-color":"rgb(31,147,255)"},on:{change:function(s){return e.userStateChanged(t.row)}},model:{value:t.row.mg_state,callback:function(s){e.$set(t.row,"mg_state",s)},expression:"scope.row.mg_state"}})]}}])}),s("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{attrs:{effect:"dark",content:"修改用户角色",placement:"bottom",enterable:!1}},[s("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-edit"},on:{click:function(s){return e.showEditUserInfoDialog(t.row.id)}}})],1),s("el-tooltip",{attrs:{effect:"dark",content:"删除用户角色",placement:"bottom",enterable:!1}},[s("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:function(s){return e.removeUserById(t.row.id)}}})],1),s("el-tooltip",{attrs:{effect:"dark",content:"分配用户角色",placement:"bottom",enterable:!1}},[s("el-button",{attrs:{size:"small",type:"warning",icon:"el-icon-setting"},on:{click:function(s){return e.showAssignRoleDialog(t.row)}}})],1)]}}])})],1),s("el-pagination",{attrs:{"current-page":e.queryInfo.pagenum,"page-sizes":[1,5,10,20],"page-size":e.queryInfo.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.userInfo.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),s("addUserDialog",{attrs:{propisAddUserDialogVisible:e.isAddUserDialogVisible},on:{"update:propisAddUserDialogVisible":function(t){e.isAddUserDialogVisible=t},"update:propis-add-user-dialog-visible":function(t){e.isAddUserDialogVisible=t},getUserList:function(t){return e.getUserList()}}}),s("editUserInfoDialog",{attrs:{propisEditUserDialogVisible:e.isEditUserDialogVisible,userId:e.editUserId},on:{"update:propisEditUserDialogVisible":function(t){e.isEditUserDialogVisible=t},"update:propis-edit-user-dialog-visible":function(t){e.isEditUserDialogVisible=t},getUserList:function(t){return e.getUserList()}}}),s("assignRoleDialog",{attrs:{propisAssignRoleDialogVisible:e.isAssignRoleDialogVisible,userInfo:e.assignRoleInfo},on:{"update:propisAssignRoleDialogVisible":function(t){e.isAssignRoleDialogVisible=t},"update:propis-assign-role-dialog-visible":function(t){e.isAssignRoleDialogVisible=t},getUserList:function(t){return e.getUserList()}}})],1)},i=[],a=(s("99af"),s("96cf"),s("1da1")),o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{title:"添加用户",visible:e.isAddUserDialogVisible,width:"30%"},on:{"update:visible":function(t){e.isAddUserDialogVisible=t},close:function(t){return e.resetAddUserForm()}}},[s("el-form",{ref:"addFormRef",attrs:{model:e.addUserForm,rules:e.addUserFormRules,"label-width":"70px"}},[s("el-form-item",{attrs:{label:"用户名",prop:"username"}},[s("el-input",{model:{value:e.addUserForm.username,callback:function(t){e.$set(e.addUserForm,"username",t)},expression:"addUserForm.username"}})],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{type:"password"},model:{value:e.addUserForm.password,callback:function(t){e.$set(e.addUserForm,"password",t)},expression:"addUserForm.password"}})],1),s("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[s("el-input",{model:{value:e.addUserForm.email,callback:function(t){e.$set(e.addUserForm,"email",t)},expression:"addUserForm.email"}})],1),s("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[s("el-input",{model:{value:e.addUserForm.mobile,callback:function(t){e.$set(e.addUserForm,"mobile",t)},expression:"addUserForm.mobile"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.isAddUserDialogVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addUser()}}},[e._v("确 定")])],1)],1)},n=[],l=s("6ac5"),u={data:function(){return{isAddUserDialogVisible:!1,addUserForm:{username:"",password:"",email:"",mobile:""}}},props:{propisAddUserDialogVisible:Boolean},beforeCreate:function(){this.addUserFormRules={username:l["a"].username,password:l["a"].password,email:l["a"].email,mobile:l["a"].mobile}},methods:{resetAddUserForm:function(){this.$refs.addFormRef.resetFields()},addUser:function(){var e=this;this.$refs.addFormRef.validate((function(t){t&&e.$axios.post("users",e.addUserForm).then((function(t){if(t=t.data,201!==t.meta.status)return 400===t.meta.status?e.$message.error("用户名已存在"):e.$message.error("添加用户失败");e.$message.success("添加用户成功"),e.isAddUserDialogVisible=!1,e.$emit("getUserList")}))}))}},watch:{isAddUserDialogVisible:function(e){this.$emit("update:propisAddUserDialogVisible",e)},propisAddUserDialogVisible:function(e){this.isAddUserDialogVisible=e}}},d=u,c=s("2877"),m=Object(c["a"])(d,o,n,!1,null,null,null),g=m.exports,p=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{title:"修改用户",visible:e.isEditUserDialogVisible,width:"30%"},on:{"update:visible":function(t){e.isEditUserDialogVisible=t}}},[s("el-form",{ref:"editUserInfoForm",attrs:{model:e.editUserForm,rules:e.editUserFormRules,"label-width":"70px"}},[s("el-form-item",{attrs:{label:"用户名"}},[s("el-input",{attrs:{disabled:!0},model:{value:e.editUserForm.username,callback:function(t){e.$set(e.editUserForm,"username",t)},expression:"editUserForm.username"}})],1),s("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[s("el-input",{model:{value:e.editUserForm.email,callback:function(t){e.$set(e.editUserForm,"email",t)},expression:"editUserForm.email"}})],1),s("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[s("el-input",{model:{value:e.editUserForm.mobile,callback:function(t){e.$set(e.editUserForm,"mobile",t)},expression:"editUserForm.mobile"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.isEditUserDialogVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.editUserInfo()}}},[e._v("确 定")])],1)],1)},f=[],b=(s("a9e3"),{data:function(){return{isEditUserDialogVisible:!1,editUserForm:{id:"",email:"",mobile:""}}},props:{propisEditUserDialogVisible:Boolean,userId:Number},beforeCreate:function(){this.editUserFormRules={email:l["a"].email,mobile:l["a"].mobile}},methods:{editUserInfo:function(){var e=this;this.$refs.editUserInfoForm.validate((function(t){t&&e.$axios.put("users/"+e.editUserForm.id,e.editUserForm).then((function(t){if(t=t.data,200!==t.meta.status)return e.$message.error("修改用户失败");e.$message.success("修改用户成功"),e.isEditUserDialogVisible=!1,e.$emit("getUserList")}))}))},getEditUserInfo:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function s(){var r,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,t.$axios.get("users/"+e);case 2:if(r=s.sent,i=r.data,200===i.meta.status){s.next=6;break}return s.abrupt("return",t.$message.error("查询用户信息失败"));case 6:t.editUserForm=i.data,t.isEditUserDialogVisible=!0;case 8:case"end":return s.stop()}}),s)})))()}},watch:{isEditUserDialogVisible:function(e){this.$emit("update:propisEditUserDialogVisible",e)},propisEditUserDialogVisible:function(e){this.isEditUserDialogVisible=e},userId:function(e){this.getEditUserInfo(e)}}}),U=b,h=Object(c["a"])(U,p,f,!1,null,null,null),v=h.exports,w=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{attrs:{title:"分配角色",visible:e.isAssignRoleDialogVisible,width:"30%"},on:{"update:visible":function(t){e.isAssignRoleDialogVisible=t}}},[s("div",[s("p",[e._v("当前的角色:"+e._s(e.userInfo.username))]),s("p",[e._v("当前的用户:"+e._s(e.userInfo.role_name))]),s("p",[e._v("分配新角色: "),s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.selectRoleId,callback:function(t){e.selectRoleId=t},expression:"selectRoleId"}},e._l(e.rolesList,(function(e){return s("el-option",{key:e.id,attrs:{label:e.roleName,value:e.id}})})),1)],1)]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.isAssignRoleDialogVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.editUserRole()}}},[e._v("确 定")])],1)])},D=[],R={data:function(){return{isAssignRoleDialogVisible:!1,rolesList:"",selectRoleId:void 0}},props:{propisAssignRoleDialogVisible:Boolean,userInfo:{type:Object,default:function(){return{}}}},methods:{editUserRole:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.put("users/"+e.userInfo.id+"/role",{rid:e.selectRoleId});case 2:if(s=t.sent,r=s.data,200===r.meta.status){t.next=6;break}return t.abrupt("return",e.$message.error("分配角色失败"));case 6:e.$message.success("分配角色成功"),e.isAssignRoleDialogVisible=!1,e.$emit("getUserList");case 9:case"end":return t.stop()}}),t)})))()},getRoleList:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("roles");case 2:if(s=t.sent,r=s.data,200===r.meta.status){t.next=6;break}return t.abrupt("return",e.$message.error("获取角色列表失败"));case 6:e.rolesList=r.data;case 7:case"end":return t.stop()}}),t)})))()}},created:function(){this.getRoleList()},watch:{isAssignRoleDialogVisible:function(e){this.$emit("update:propisAssignRoleDialogVisible",e)},propisAssignRoleDialogVisible:function(e){this.isAssignRoleDialogVisible=e}}},V=R,$=Object(c["a"])(V,w,D,!1,null,null,null),x=$.exports,I={components:{addUserDialog:g,editUserInfoDialog:v,assignRoleDialog:x},data:function(){return{queryInfo:{query:"",pagenum:1,pagesize:5},userInfo:{userlist:[],total:0},isAddUserDialogVisible:!1,isEditUserDialogVisible:!1,isAssignRoleDialogVisible:!1,editUserId:void 0,assignRoleInfo:void 0}},created:function(){this.getUserList()},methods:{getUserList:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("users",{params:e.queryInfo});case 2:if(s=t.sent,r=s.data,e.userInfo.userlist=r.data.users,e.userInfo.total=r.data.total,200===r.meta.status){t.next=8;break}return t.abrupt("return",e.$message.error(r.meta.msg));case 8:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.queryInfo.pagesize=e,this.getUserList()},handleCurrentChange:function(e){this.queryInfo.pagenum=e,this.getUserList()},userStateChanged:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function s(){var r,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,t.$axios.put("users/".concat(e.id,"/state/").concat(e.mg_state));case 2:if(r=s.sent,i=r.data,200===i.meta.status){s.next=7;break}return ueserinfo.mg_state=!ueserinfo.mg_state,s.abrupt("return",t.$message.error(i.meta.msg));case 7:t.$message.success("更新用户状态成功");case 8:case"end":return s.stop()}}),s)})))()},showEditUserInfoDialog:function(e){this.editUserId=e,this.isEditUserDialogVisible=!0},removeUserById:function(e){var t=this;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(a["a"])(regeneratorRuntime.mark((function s(){var r,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,t.$axios.delete("users/"+e);case 2:r=s.sent,i=r.data,200===i.meta.status?(t.$message.success("删除成功"),t.getUserList()):t.$message.warning("删除失败!");case 5:case"end":return s.stop()}}),s)})))).catch((function(){t.$message.info("已取消删除")}))},showAssignRoleDialog:function(e){this.assignRoleInfo=e,this.isAssignRoleDialogVisible=!0}},watch:{}},_=I,A=Object(c["a"])(_,r,i,!1,null,null,null);t["default"]=A.exports},"6ac5":function(e,t,s){"use strict";var r=function(e,t,s){var r=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+\.([a-zA-Z0-9_-])+$/;if(r.test(t))return s();s(new Error("邮箱格式有误"))},i=function(e,t,s){var r=/^(1[3|5-9]\d{9})$/;if(r.test(t))return s();s(new Error("手机格式有误"))};t["a"]={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:10,message:"请输入长度为3~10位以内的用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:15,message:"请输入长度为6~15位以内的密码",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:r,trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号码",trigger:"blur"},{validator:i,trigger:"blur"}],goods_name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],goods_price:[{required:!0,message:"请输入商品价格",trigger:"blur"}],goods_number:[{required:!0,message:"请输入商品数目",trigger:"blur"}],goods_weight:[{required:!0,message:"请输入商品重量",trigger:"blur"}],goods_cat:[{required:!0,message:"请选择商品分类",trigger:"blur"}],address_province:[{required:!0,message:"请选择省市区县",trigger:"blur"}],address_detail:[{required:!0,message:"请输入详细地址",trigger:"blur"}]}}}]);
//# sourceMappingURL=users.95b6d339.js.map